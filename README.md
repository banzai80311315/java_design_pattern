# java design pattern
## Iteratorãƒ‘ã‚¿ãƒ¼ãƒ³
é›†åˆä½“ï¼ˆAggregate)å†…éƒ¨ã®è¦ç´ ã‚’é †ç•ªã«å–ã‚Šå‡ºã™ãŸã‚ã®æ–¹æ³•ï¼ˆIteratorï¼‰ã‚’æä¾›ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã€‚

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**

`BookShelf`ã‚’ã©ã®ã‚ˆã†ã«ä¿®æ­£ã—ã‚ˆã†ã¨ã‚‚ã€`BookShelf`ãŒ`iterator`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã£ã¦ã„ã¦ã€æ­£ã—ã„`Iterator<Book>`ã‚’è¿”ã—ã¦ãã‚Œã•ãˆã™ã‚Œã°`main`ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒãªã„

## Adapterãƒ‘ã‚¿ãƒ¼ãƒ³
ã€Œã™ã§ã«æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®(Adaptee)ã€ã¨ã€Œå¿…è¦ãªã‚‚ã®(Target)ã€ã®é–“ã®ã€Œãšã‚Œã€ã‚’åŸ‹ã‚ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã€‚

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**

```java
Print print = new PrintBanner();
```

ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã«å¯¾ã—ã¦`Print`å‹ã®å‚ç…§ã‚’æŒã£ãŸ`print`ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚
ãã—ã¦ã€ãƒ’ãƒ¼ãƒ—é ˜åŸŸã«å¯¾ã—ã¦`PrintBanner`å‹ã®å®Ÿæ…‹ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚
ã“ã®ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å†…å®¹ã¯`PrintBanner`å‹ã®ã‚‚ã®ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚
ã¾ãŸã€`Print`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ç”¨ã„ã‚‹ã¨ã„ã†ç‚¹ã‚’å¼·èª¿ã§ãã‚‹ã€‚

**ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸ**
- å¤‰æ•°`print`ãŒæ ¼ç´
- å‹ã¯`Print`
- å€¤ã¯ãƒ’ãƒ¼ãƒ—ä¸Šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‚ç…§

**ãƒ’ãƒ¼ãƒ—é ˜åŸŸ**
- `new PrintBanner()`ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ ¼ç´
- å®Ÿæ…‹ã¯`PrintBanner`å‹

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**

[Javaãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«](https://qiita.com/AsahinaKei/items/93e50eee48e317814fbd)

ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Œå¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã€ã®ã“ã¨ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šæƒ…å ±ã‚’ã€Œå¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã€ã¨ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨åˆ†é›¢ã•ã›ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã®å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å†ãƒ“ãƒ«ãƒ‰ã‚’ã›ãšã«æŒ™å‹•ã‚’å¤‰ãˆã‚‹ã“ã¨ãªã©ãŒã§ãä¾¿åˆ©ã€‚


## Template Methodãƒ‘ã‚¿ãƒ¼ãƒ³
ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã§å‡¦ç†ã®æ çµ„ã¿ã‚’å®šã‚ã¦ã€ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ãã®å…·ä½“çš„ãªå†…å®¹ã‚’å®šã‚ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã€‚

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**

[InputStream](https://docs.oracle.com/javase/jp/8/docs/api/java/io/InputStream.html)

### ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ï¼ˆã‚¢ã‚¯ã‚»ã‚¹æ¼”ç®—å­ï¼‰ã¨ã¯ï¼Ÿ
Javaã®ã‚¯ãƒ©ã‚¹ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦ã€Œ**ã©ã“ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹**ã€ã‚’åˆ¶å¾¡ã™ã‚‹ã‚‚ã®ã€‚

| ä¿®é£¾å­ | æ„å‘³ | ã‚¢ã‚¯ã‚»ã‚¹ç¯„å›² |
|--------|------|--------------|
| `public` | å…¬é–‹ | ã©ã“ã‹ã‚‰ã§ã‚‚OK |
| `protected` | ç¶™æ‰¿å…ƒãƒ»åŒä¸€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã¨åŒä¸€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ |
| ï¼ˆãªã—ï¼‰ | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ | åŒä¸€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã®ã¿ |
| `private` | éå…¬é–‹ | åŒä¸€ã‚¯ãƒ©ã‚¹å†…ã®ã¿ |

---

### `final` ã¨ã¯ï¼Ÿ
ã€Œ**ã“ã‚Œä»¥ä¸Šå¤‰æ›´ã§ãã¾ã›ã‚“ï¼**ã€ã¨ã„ã†åˆ¶é™ã‚’ã‹ã‘ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€‚

| ç”¨é€”     | ä¾‹                        | æ„å‘³                         |
|----------|---------------------------|------------------------------|
| å¤‰æ•°     | `final int x = 10;`       | å€¤ã®å†ä»£å…¥ç¦æ­¢ï¼ˆå®šæ•°ï¼‰       |
| ãƒ¡ã‚½ãƒƒãƒ‰ | `final void run()`        | ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ç¦æ­¢           |
| ã‚¯ãƒ©ã‚¹   | `final class Foo`         | ç¶™æ‰¿ç¦æ­¢ï¼ˆã‚µãƒ–ã‚¯ãƒ©ã‚¹ä½œã‚Œãªã„ï¼‰|

---
## Factory Methodãƒ‘ã‚¿ãƒ¼ãƒ³
Templateãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã—ã¦ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆã®å ´é¢ã«é©ç”¨ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã“ã¨ã€‚

sampleã§ã¯ã€`framework`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯`idcard`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‘¼ã³å‡ºã—ã¦ã„ãªã„ã“ã¨ã‹ã‚‰ã€Œ`framework`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯`idcard`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ä¾å­˜ã—ã¦ã„ãªã„ã€ã¨è¡¨ç¾ã§ãã¾ã™ã€‚

### static Factory Methodã«ã¤ã„ã¦
ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆã®ãŸã‚ã®ã‚¯ãƒ©ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’static Factory Methodã¨å‘¼ã¶ã€‚

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**

Concreateãªã‚¯ãƒ©ã‚¹ã®ã¿ä¿®æ­£

## Singletonãƒ‘ã‚¿ãƒ¼ãƒ³

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**

[Arrays](https://docs.oracle.com/javase/jp/8/docs/api/java/util/Arrays.html)

[ãƒ©ãƒ ãƒ€å¼](https://qiita.com/kenRp01/items/4045a7925340088bd7e3)

è§£ç­”ã®åˆæœŸåŒ–å­ã¯ä»¥ä¸‹ã¨åŒç­‰

```java
Arrays.stream(names).forEach(s -> map.put(s, new Triple(s)));
# åŒç­‰
for (String s : names) {
    map.put(s, new Triple(s));
}
```

**ç·´ç¿’å•é¡Œãƒã‚¤ãƒ³ãƒˆ**
synchronizedã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã§ã€Œã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯1ã¤ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã—ã‹åŒæ™‚ã«å®Ÿè¡Œã—ãªã„ã€ã¨ã„ãƒ­ãƒƒã‚¯ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```java
public static synchronized SynchronizedSingleton getInstance() {
	if(singleton == null) {
		singleton = new SynchronizedSingleton();
	}
	return singleton;
}
``` 

ã‚¤ãƒ¡ãƒ¼ã‚¸


```bash
Thread A:  â†’â†’ getInstance() â†ğŸ”’ ãƒ­ãƒƒã‚¯ã‚’å–å¾—ï¼ä»–ã¯å¾…ã£ã¦ï¼
              â†“
          singleton == null â†’ new BadSingleton()
              â†“
              return instance
              ğŸ”“ ãƒ­ãƒƒã‚¯è§£é™¤

Thread B: ï¼ˆãã®é–“ã¯å¾…æ©Ÿï¼‰
Thread C: ï¼ˆãã®é–“ã¯å¾…æ©Ÿï¼‰
Thread D: ï¼ˆãã®é–“ã¯å¾…æ©Ÿï¼‰
```

